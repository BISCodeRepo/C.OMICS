  <div id="heatmapDiv" style="width: 90%; height: 600px;margin: auto;"></div>

  <script type="text/javascript">

    var matrix = []
    var rowHeader = []
    var metaData = []
    var patientData = []

    $.ajax({
      type: "GET",
      url: "../file/Quantitation_genes.csv",
      dataType: "text",
      cache: false,
      success: function (data) {
        data = data.split("\n");
        let seqPateint = data[0].split(",").slice(1)
        let rows = data.slice(1).map((row) => row.split(","));
        rows.map((row) => {
          rowHeader.push(row[0])
        });
        rows.map((row) => {
          matrix.push(row.slice(1))
        });
        data = metaArray;
        rows = data.map((row) => row.split(","));
        rows = dataToArray(rows)
        let tempRows = rows.slice(1)
        tempRows = tempRows.filter((row) => seqPateint.includes(row[0]))
        rows = rows.slice(0, 1)
        tempRows.forEach(element => rows.push(element));
        rows = dataToArray(rows)
        const patientHeader = []
        rows.map((row) => {
          patientHeader.push(row[0])
          patientData.push(row.slice(1))
        });
        for (let i = 0; i < patientHeader.length; i++) {
          metaData.push({
            name: patientHeader[i],
            array: patientData[i]
          })
        }
        drawHeatMap();
      },
    });

    function dataToArray(array) {
      const rows = array.length;
      const cols = array[0].length;
      const transposed = [];
      for (let col = 0; col < cols; col++) {
        const newRow = [];
        for (let row = 0; row < rows; row++) {
          newRow.push(array[row][col]);
        }
        transposed.push(newRow);
      }
      return transposed;
    }



    //draw
    function drawHeatMap() {
      let json = {
        rows: rowHeader.length,
        columns: patientData[0].length,
        seriesArrays: [matrix],
        seriesDataTypes: ["Float32"],
        seriesNames: ["Gene"],
        rowMetadataModel: {
          vectors: [
            {
              name: "Gene",
              array: rowHeader,
            },
          ],
        },
        columnMetadataModel: {
          vectors: metaData
        },
      };

      new morpheus.HeatMap({
        el: $('#heatmapDiv'),
        dataset: morpheus.Dataset.fromJSON(json),
        colorScheme: {
          type: 'fixed',
        },
      });
      menu: toolbarMenu
    }




  </script>